{"id":"../node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/AudioContextQueue.js","dependencies":[{"name":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/AudioContextQueue.js.map","includedInParent":true,"mtime":1733074798686},{"name":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/package.json","includedInParent":true,"mtime":1733076065657},{"name":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/package.json","includedInParent":true,"mtime":1733074798686},{"name":"@babel/runtime/helpers/interopRequireDefault","loc":{"line":3,"column":37,"index":52},"parent":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/AudioContextQueue.js","resolved":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/node_modules/@babel/runtime/helpers/interopRequireDefault.js"},{"name":"@babel/runtime/regenerator","loc":{"line":10,"column":50,"index":244},"parent":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/AudioContextQueue.js","resolved":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/node_modules/@babel/runtime/regenerator/index.js"},{"name":"@babel/runtime/helpers/asyncToGenerator","loc":{"line":12,"column":56,"index":333},"parent":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/AudioContextQueue.js","resolved":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/node_modules/@babel/runtime/helpers/asyncToGenerator.js"},{"name":"@babel/runtime/helpers/classCallCheck","loc":{"line":14,"column":54,"index":433},"parent":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/AudioContextQueue.js","resolved":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/node_modules/@babel/runtime/helpers/classCallCheck.js"},{"name":"@babel/runtime/helpers/createClass","loc":{"line":16,"column":51,"index":528},"parent":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/AudioContextQueue.js","resolved":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/node_modules/@babel/runtime/helpers/createClass.js"},{"name":"memoize-one","loc":{"line":18,"column":49,"index":618},"parent":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/AudioContextQueue.js","resolved":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/memoize-one/dist/memoize-one.esm.js"},{"name":"./AudioContextConsumer","loc":{"line":20,"column":59,"index":695},"parent":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/AudioContextQueue.js","resolved":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/AudioContextConsumer.js"}],"generated":{"js":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _memoizeOne = _interopRequireDefault(require(\"memoize-one\"));\n\nvar _AudioContextConsumer = _interopRequireDefault(require(\"./AudioContextConsumer\"));\n\n/* eslint no-await-in-loop: \"off\" */\nvar _default = /*#__PURE__*/function () {\n  function _default(_ref) {\n    var audioContext = _ref.audioContext,\n        ponyfill = _ref.ponyfill;\n    (0, _classCallCheck2.default)(this, _default);\n    this.consumer = null;\n    this.paused = false;\n    this.queue = [];\n    this.getAudioContext = (0, _memoizeOne.default)(function () {\n      return audioContext || new ponyfill.AudioContext();\n    });\n  }\n\n  (0, _createClass2.default)(_default, [{\n    key: \"pause\",\n    value: function pause() {\n      this.paused = true;\n      this.consumer && this.consumer.pause();\n    }\n  }, {\n    key: \"push\",\n    value: function push(utterance) {\n      this.queue.push(utterance);\n      this.startConsumer();\n    }\n  }, {\n    key: \"resume\",\n    value: function resume() {\n      this.paused = false;\n\n      if (this.consumer) {\n        this.consumer.resume();\n      } else {\n        this.startConsumer();\n      }\n    }\n  }, {\n    key: \"speaking\",\n    get: function get() {\n      return !!this.consumer;\n    }\n  }, {\n    key: \"startConsumer\",\n    value: function () {\n      var _startConsumer = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(!this.paused && this.queue.length && !this.consumer)) {\n                  _context.next = 7;\n                  break;\n                }\n\n                this.consumer = new _AudioContextConsumer.default(this.getAudioContext());\n                _context.next = 4;\n                return this.consumer.start(this.queue);\n\n              case 4:\n                this.consumer = null;\n                _context.next = 0;\n                break;\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function startConsumer() {\n        return _startConsumer.apply(this, arguments);\n      }\n\n      return startConsumer;\n    }()\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      this.queue.splice(0);\n      this.consumer && this.consumer.stop();\n    }\n  }]);\n  return _default;\n}();\n\nexports.default = _default;\n"},"sourceMaps":{"js":{"version":3,"file":"AudioContextQueue.js","names":["audioContext","ponyfill","consumer","paused","queue","getAudioContext","memoize","AudioContext","pause","utterance","push","startConsumer","resume","length","AudioContextConsumer","start","splice","stop"],"sources":["../../../src/SpeechServices/TextToSpeech/AudioContextQueue.js"],"sourcesContent":["/* eslint no-await-in-loop: \"off\" */\n\nimport memoize from 'memoize-one';\n\nimport AudioContextConsumer from './AudioContextConsumer';\n\nexport default class {\n  constructor({ audioContext, ponyfill }) {\n    this.consumer = null;\n    this.paused = false;\n    this.queue = [];\n\n    this.getAudioContext = memoize(() => audioContext || new ponyfill.AudioContext());\n  }\n\n  pause() {\n    this.paused = true;\n    this.consumer && this.consumer.pause();\n  }\n\n  push(utterance) {\n    this.queue.push(utterance);\n    this.startConsumer();\n  }\n\n  resume() {\n    this.paused = false;\n\n    if (this.consumer) {\n      this.consumer.resume();\n    } else {\n      this.startConsumer();\n    }\n  }\n\n  get speaking() {\n    return !!this.consumer;\n  }\n\n  async startConsumer() {\n    while (!this.paused && this.queue.length && !this.consumer) {\n      this.consumer = new AudioContextConsumer(this.getAudioContext());\n\n      await this.consumer.start(this.queue);\n\n      this.consumer = null;\n    }\n  }\n\n  stop() {\n    this.queue.splice(0);\n    this.consumer && this.consumer.stop();\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;AAEA;;AAEA;;AAJA;;EAOE,wBAAwC;IAAA,IAA1BA,YAA0B,QAA1BA,YAA0B;IAAA,IAAZC,QAAY,QAAZA,QAAY;IAAA;IACtC,KAAKC,QAAL,GAAgB,IAAhB;IACA,KAAKC,MAAL,GAAc,KAAd;IACA,KAAKC,KAAL,GAAa,EAAb;IAEA,KAAKC,eAAL,GAAuB,IAAAC,mBAAA,EAAQ;MAAA,OAAMN,YAAY,IAAI,IAAIC,QAAQ,CAACM,YAAb,EAAtB;IAAA,CAAR,CAAvB;EACD;;;;WAED,iBAAQ;MACN,KAAKJ,MAAL,GAAc,IAAd;MACA,KAAKD,QAAL,IAAiB,KAAKA,QAAL,CAAcM,KAAd,EAAjB;IACD;;;WAED,cAAKC,SAAL,EAAgB;MACd,KAAKL,KAAL,CAAWM,IAAX,CAAgBD,SAAhB;MACA,KAAKE,aAAL;IACD;;;WAED,kBAAS;MACP,KAAKR,MAAL,GAAc,KAAd;;MAEA,IAAI,KAAKD,QAAT,EAAmB;QACjB,KAAKA,QAAL,CAAcU,MAAd;MACD,CAFD,MAEO;QACL,KAAKD,aAAL;MACD;IACF;;;SAED,eAAe;MACb,OAAO,CAAC,CAAC,KAAKT,QAAd;IACD;;;;mGAED;QAAA;UAAA;YAAA;cAAA;gBAAA,MACS,CAAC,KAAKC,MAAN,IAAgB,KAAKC,KAAL,CAAWS,MAA3B,IAAqC,CAAC,KAAKX,QADpD;kBAAA;kBAAA;gBAAA;;gBAEI,KAAKA,QAAL,GAAgB,IAAIY,6BAAJ,CAAyB,KAAKT,eAAL,EAAzB,CAAhB;gBAFJ;gBAAA,OAIU,KAAKH,QAAL,CAAca,KAAd,CAAoB,KAAKX,KAAzB,CAJV;;cAAA;gBAMI,KAAKF,QAAL,GAAgB,IAAhB;gBANJ;gBAAA;;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,C;;;;;;;;;;WAUA,gBAAO;MACL,KAAKE,KAAL,CAAWY,MAAX,CAAkB,CAAlB;MACA,KAAKd,QAAL,IAAiB,KAAKA,QAAL,CAAce,IAAd,EAAjB;IACD"}},"error":null,"hash":"9c74a42d25301d9b57ba1f9adfed1550","cacheData":{"env":{}}}