{"id":"../node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/fetchCustomVoices.js","dependencies":[{"name":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/fetchCustomVoices.js.map","includedInParent":true,"mtime":1733074798686},{"name":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/package.json","includedInParent":true,"mtime":1733076065657},{"name":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/package.json","includedInParent":true,"mtime":1733074798686},{"name":"@babel/runtime/helpers/interopRequireDefault","loc":{"line":3,"column":37,"index":52},"parent":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/fetchCustomVoices.js","resolved":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/node_modules/@babel/runtime/helpers/interopRequireDefault.js"},{"name":"@babel/runtime/regenerator","loc":{"line":10,"column":50,"index":246},"parent":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/fetchCustomVoices.js","resolved":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/node_modules/@babel/runtime/regenerator/index.js"},{"name":"@babel/runtime/helpers/asyncToGenerator","loc":{"line":12,"column":56,"index":335},"parent":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/fetchCustomVoices.js","resolved":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/node_modules/@babel/runtime/helpers/asyncToGenerator.js"},{"name":"./SpeechSynthesisVoice","loc":{"line":14,"column":59,"index":440},"parent":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/fetchCustomVoices.js","resolved":"/Users/amblardv5/Nextcloud/2024/dialogue-systems-1-2024/node_modules/web-speech-cognitive-services/lib/SpeechServices/TextToSpeech/SpeechSynthesisVoice.js"}],"generated":{"js":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = _default;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _SpeechSynthesisVoice = _interopRequireDefault(require(\"./SpeechSynthesisVoice\"));\n\n/* eslint no-magic-numbers: [\"error\", { \"ignore\": [0, 1, -1] }] */\nfunction fetchCustomVoices(_x) {\n  return _fetchCustomVoices.apply(this, arguments);\n}\n\nfunction _fetchCustomVoices() {\n  _fetchCustomVoices = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(_ref) {\n    var customVoiceHostname, deploymentId, region, subscriptionKey, hostname, res;\n    return _regenerator.default.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            customVoiceHostname = _ref.customVoiceHostname, deploymentId = _ref.deploymentId, region = _ref.region, subscriptionKey = _ref.subscriptionKey;\n            hostname = customVoiceHostname || \"\".concat(region, \".customvoice.api.speech.microsoft.com\"); // Although encodeURI on a hostname doesn't work as expected for hostname, at least, it will fail peacefully.\n\n            _context.next = 4;\n            return fetch(\"https://\".concat(encodeURI(hostname), \"/api/texttospeech/v2.0/endpoints/\").concat(encodeURIComponent(deploymentId)), {\n              headers: {\n                accept: 'application/json',\n                'ocp-apim-subscription-key': subscriptionKey\n              }\n            });\n\n          case 4:\n            res = _context.sent;\n\n            if (res.ok) {\n              _context.next = 7;\n              break;\n            }\n\n            throw new Error('Failed to fetch custom voices');\n\n          case 7:\n            return _context.abrupt(\"return\", res.json());\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _fetchCustomVoices.apply(this, arguments);\n}\n\nfunction _default(_x2) {\n  return _ref3.apply(this, arguments);\n}\n\nfunction _ref3() {\n  _ref3 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2(_ref2) {\n    var customVoiceHostname, deploymentId, region, subscriptionKey, _yield$fetchCustomVoi, models;\n\n    return _regenerator.default.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            customVoiceHostname = _ref2.customVoiceHostname, deploymentId = _ref2.deploymentId, region = _ref2.region, subscriptionKey = _ref2.subscriptionKey;\n            _context2.next = 3;\n            return fetchCustomVoices({\n              customVoiceHostname: customVoiceHostname,\n              deploymentId: deploymentId,\n              region: region,\n              subscriptionKey: subscriptionKey\n            });\n\n          case 3:\n            _yield$fetchCustomVoi = _context2.sent;\n            models = _yield$fetchCustomVoi.models;\n            return _context2.abrupt(\"return\", models.map(function (_ref4) {\n              var gender = _ref4.properties.Gender,\n                  lang = _ref4.locale,\n                  voiceURI = _ref4.name;\n              return new _SpeechSynthesisVoice.default({\n                gender: gender,\n                lang: lang,\n                voiceURI: voiceURI\n              });\n            }).sort(function (_ref5, _ref6) {\n              var x = _ref5.name;\n              var y = _ref6.name;\n              return x > y ? 1 : x < y ? -1 : 0;\n            }));\n\n          case 6:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _ref3.apply(this, arguments);\n}\n"},"sourceMaps":{"js":{"version":3,"file":"fetchCustomVoices.js","names":["fetchCustomVoices","customVoiceHostname","deploymentId","region","subscriptionKey","hostname","fetch","encodeURI","encodeURIComponent","headers","accept","res","ok","Error","json","models","map","gender","properties","Gender","lang","locale","voiceURI","name","SpeechSynthesisVoice","sort","x","y"],"sources":["../../../src/SpeechServices/TextToSpeech/fetchCustomVoices.js"],"sourcesContent":["/* eslint no-magic-numbers: [\"error\", { \"ignore\": [0, 1, -1] }] */\n\nimport SpeechSynthesisVoice from './SpeechSynthesisVoice';\n\nasync function fetchCustomVoices({ customVoiceHostname, deploymentId, region, subscriptionKey }) {\n  const hostname = customVoiceHostname || `${ region }.customvoice.api.speech.microsoft.com`;\n\n  // Although encodeURI on a hostname doesn't work as expected for hostname, at least, it will fail peacefully.\n  const res = await fetch(\n    `https://${ encodeURI(hostname) }/api/texttospeech/v2.0/endpoints/${ encodeURIComponent(deploymentId) }`,\n    {\n      headers: {\n        accept: 'application/json',\n        'ocp-apim-subscription-key': subscriptionKey\n      }\n    }\n  );\n\n  if (!res.ok) {\n    throw new Error('Failed to fetch custom voices');\n  }\n\n  return res.json();\n}\n\nexport default async function({ customVoiceHostname, deploymentId, region, subscriptionKey }) {\n  const { models } = await fetchCustomVoices({ customVoiceHostname, deploymentId, region, subscriptionKey });\n\n  return models\n    .map(\n      ({ properties: { Gender: gender }, locale: lang, name: voiceURI }) =>\n        new SpeechSynthesisVoice({ gender, lang, voiceURI })\n    )\n    .sort(({ name: x }, { name: y }) => (x > y ? 1 : x < y ? -1 : 0));\n}\n"],"mappings":";;;;;;;;;;;;;AAEA;;AAFA;SAIeA,iB;;;;;+FAAf;IAAA;IAAA;MAAA;QAAA;UAAA;YAAmCC,mBAAnC,QAAmCA,mBAAnC,EAAwDC,YAAxD,QAAwDA,YAAxD,EAAsEC,MAAtE,QAAsEA,MAAtE,EAA8EC,eAA9E,QAA8EA,eAA9E;YACQC,QADR,GACmBJ,mBAAmB,cAAQE,MAAR,0CADtC,EAGE;;YAHF;YAAA,OAIoBG,KAAK,mBACTC,SAAS,CAACF,QAAD,CADA,8CACgDG,kBAAkB,CAACN,YAAD,CADlE,GAErB;cACEO,OAAO,EAAE;gBACPC,MAAM,EAAE,kBADD;gBAEP,6BAA6BN;cAFtB;YADX,CAFqB,CAJzB;;UAAA;YAIQO,GAJR;;YAAA,IAcOA,GAAG,CAACC,EAdX;cAAA;cAAA;YAAA;;YAAA,MAeU,IAAIC,KAAJ,CAAU,+BAAV,CAfV;;UAAA;YAAA,iCAkBSF,GAAG,CAACG,IAAJ,EAlBT;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,C;;;;;;;;;kFAqBe;IAAA;;IAAA;MAAA;QAAA;UAAA;YAAiBb,mBAAjB,SAAiBA,mBAAjB,EAAsCC,YAAtC,SAAsCA,YAAtC,EAAoDC,MAApD,SAAoDA,MAApD,EAA4DC,eAA5D,SAA4DA,eAA5D;YAAA;YAAA,OACYJ,iBAAiB,CAAC;cAAEC,mBAAmB,EAAnBA,mBAAF;cAAuBC,YAAY,EAAZA,YAAvB;cAAqCC,MAAM,EAANA,MAArC;cAA6CC,eAAe,EAAfA;YAA7C,CAAD,CAD7B;;UAAA;YAAA;YACLW,MADK,yBACLA,MADK;YAAA,kCAGNA,MAAM,CACVC,GADI,CAEH;cAAA,IAAyBC,MAAzB,SAAGC,UAAH,CAAiBC,MAAjB;cAAA,IAA2CC,IAA3C,SAAmCC,MAAnC;cAAA,IAAuDC,QAAvD,SAAiDC,IAAjD;cAAA,OACE,IAAIC,6BAAJ,CAAyB;gBAAEP,MAAM,EAANA,MAAF;gBAAUG,IAAI,EAAJA,IAAV;gBAAgBE,QAAQ,EAARA;cAAhB,CAAzB,CADF;YAAA,CAFG,EAKJG,IALI,CAKC;cAAA,IAASC,CAAT,SAAGH,IAAH;cAAA,IAAsBI,CAAtB,SAAgBJ,IAAhB;cAAA,OAA+BG,CAAC,GAAGC,CAAJ,GAAQ,CAAR,GAAYD,CAAC,GAAGC,CAAJ,GAAQ,CAAC,CAAT,GAAa,CAAxD;YAAA,CALD,CAHM;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,C"}},"error":null,"hash":"d701d492dd5d8befefb705372abc80be","cacheData":{"env":{}}}